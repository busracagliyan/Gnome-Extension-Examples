<h2 id="gnome-shell-eklentisi-nas-l-olu-turulur-">Gnome-Shell Eklentisi Nasıl Oluşturulur?</h2>
<p>Bu yazıda Pardus 21’in gnome masaüstü için basit bir gnome-shell eklentisi yapmayı öğreneceğiz. Eklentimiz panele ikon ekleyecek ve ikona tıkladığımızda açılan popup menu bize bildirim gönderecek. </p>
<p>İlk olarak home klasörüne giriyoruz ve ctrl+h yapıp gizli dosyaları açıyoruz. Daha sonra .local/share/gnome-shell/extensions dizin konumuna giriyoruz. Burada extensions klasöründe example@example.com isimli yeni bir klasör oluşturuyoruz. Bu klasörün içerisinde extension.js ve metadata.json dosyalarını oluşturuyoruz. </p>
<p>Metadata.json dosyası eklenti bilgilerinin olduğu dosyadır. Aşağıda gösterildiği gibi yazılır.</p>
<h3 id="metadata-json">metadata.json</h3>
<pre><code class="lang-json">{ 
    <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"example@example.com"</span>, 
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Example"</span>, 
    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"This extension puts an icon in the panel with a simple popup menu."</span>, 
    <span class="hljs-attr">"version"</span>: <span class="hljs-number">1</span>, 
    <span class="hljs-attr">"shell-version"</span>: [ <span class="hljs-string">"3.38"</span> ], 
    <span class="hljs-attr">"url"</span>: <span class="hljs-string">""</span> 
}
</code></pre>
<ul>
<li>Uuid: Benzersiz bir isimdir ve dosya ismi ile aynı olmak zorundadır. </li>
<li>Name: Eklentinin ismi, kısa ve açıklayıcı olmalıdır. Örneğin Application Menu, Extension List, Dash to Dock vs. </li>
<li>Description: Eklentinin ne işe yaradığını kısaca açıklar. </li>
<li>Version: Eklentinin kaçıncı sürüm olduğunu belirtir. Tam sayı şeklinde olmalıdır. </li>
<li>Shell-version: Kullandığımız gnome sürümünü burada tanımlamalıyız. Pardus 21 3.38.6 gnome sürümünü kullanıyor. </li>
<li>Url: Yaptımız eklentinin linki varsa bu kısma ekliyoruz. </li>
</ul>
<p>metadata.json dosyamızı oluşturduktan sonra extension.js dosyamızı oluşturuyoruz. </p>
<h3 id="extension-js">extension.js</h3>
<pre><code class="lang-js"><span class="hljs-meta">'use strict'</span>; 

<span class="hljs-keyword">const</span> ExtensionUtils = imports.misc.extensionUtils; 
<span class="hljs-keyword">const</span> Me = ExtensionUtils.getCurrentExtension(); 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`initializing <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 
} 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enable</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`enabling <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 
} 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`disabling <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 
}
</code></pre>
<p>extension.js dosyamızın iskelet hali yukarıdaki gibidir. Şimdi dosyamıza ilk olarak kullanacağımız kütüphaneleri ekleyelim. </p>
<pre><code class="lang-js"><span class="hljs-meta">'use strict'</span>;  

<span class="hljs-keyword">const</span> {Gio, GLib, GObject, St} = imports.gi;  
<span class="hljs-keyword">const</span> Main = imports.ui.main; 
<span class="hljs-keyword">const</span> PanelMenu = imports.ui.panelMenu; 
<span class="hljs-keyword">const</span> PopupMenu = imports.ui.popupMenu; 

<span class="hljs-keyword">const</span> ExtensionUtils = imports.misc.extensionUtils;  
<span class="hljs-keyword">const</span> Me = ExtensionUtils.getCurrentExtension(); 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`initializing <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 
} 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enable</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`enabling <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 
} 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`disabling <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 
}
</code></pre>
<p>Şimdi eklentimiz için ikon ekleyelim.</p>
<pre><code class="lang-js"><span class="hljs-meta">'use strict'</span>; 

<span class="hljs-keyword">const</span> {Gio, GLib, GObject, St} = imports.gi; 
<span class="hljs-keyword">const</span> Main = imports.ui.main;
<span class="hljs-keyword">const</span> PanelMenu = imports.ui.panelMenu;
<span class="hljs-keyword">const</span> PopupMenu = imports.ui.popupMenu;

<span class="hljs-keyword">const</span> ExtensionUtils = imports.misc.extensionUtils; 
<span class="hljs-keyword">const</span> Me = ExtensionUtils.getCurrentExtension();

<span class="hljs-keyword">let</span> Indicator = GObject.registerClass(
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Indicator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PanelMenu</span>.<span class="hljs-title">Button</span></span>{

        _init() {
            <span class="hljs-keyword">super</span>._init(<span class="hljs-number">0.0</span>, <span class="hljs-string">`<span class="hljs-subst">${Me.metadata.name}</span> Indicator`</span>, <span class="hljs-literal">false</span>);

            <span class="hljs-keyword">let</span> icon =<span class="hljs-keyword">new</span> St.Icon({
                <span class="hljs-attr">icon_name</span>: <span class="hljs-string">'face-smile-symbolic'</span>,
                <span class="hljs-attr">style_class</span>: <span class="hljs-string">'system-status-icon'</span>
            });
            <span class="hljs-keyword">this</span>.actor.add_child(icon);
        }        
});

<span class="hljs-keyword">let</span> indicator = <span class="hljs-literal">null</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`initializing <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 
} 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enable</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`enabling <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>);

    indicator = <span class="hljs-keyword">new</span> Indicator();
    Main.panel.addToStatusArea(<span class="hljs-string">`<span class="hljs-subst">${Me.metadata.name}</span> Indicator`</span>, indicator);
} 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`disabling <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 

    <span class="hljs-keyword">if</span> (indicator !== <span class="hljs-literal">null</span>) {
        indicator.destroy();
        indicator = <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<p>Daha sonra eklentimize popup menu ekleyip bildirim oluşturalım. </p>
<pre><code class="lang-js"><span class="hljs-meta">'use strict'</span>; 

<span class="hljs-keyword">const</span> {Gio, GLib, GObject, St} = imports.gi; 
<span class="hljs-keyword">const</span> Main = imports.ui.main;
<span class="hljs-keyword">const</span> PanelMenu = imports.ui.panelMenu;
<span class="hljs-keyword">const</span> PopupMenu = imports.ui.popupMenu;

<span class="hljs-keyword">const</span> ExtensionUtils = imports.misc.extensionUtils; 
<span class="hljs-keyword">const</span> Me = ExtensionUtils.getCurrentExtension();

<span class="hljs-keyword">let</span> Indicator = GObject.registerClass(
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Indicator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PanelMenu</span>.<span class="hljs-title">Button</span></span>{

        _init() {
            <span class="hljs-keyword">super</span>._init(<span class="hljs-number">0.0</span>, <span class="hljs-string">`<span class="hljs-subst">${Me.metadata.name}</span> Indicator`</span>, <span class="hljs-literal">false</span>);

            <span class="hljs-keyword">let</span> icon =<span class="hljs-keyword">new</span> St.Icon({
                <span class="hljs-attr">icon_name</span>: <span class="hljs-string">'face-smile-symbolic'</span>,
                <span class="hljs-attr">style_class</span>: <span class="hljs-string">'system-status-icon'</span>
            });
            <span class="hljs-keyword">this</span>.actor.add_child(icon);

            <span class="hljs-keyword">let</span> item = <span class="hljs-keyword">new</span> PopupMenu.PopupMenuItem(_(<span class="hljs-string">'Show Notification'</span>)); 
            item.connect(<span class="hljs-string">'activate'</span>, () =&gt; {
                Main.notify(_(<span class="hljs-string">'Whatʼs up?'</span>));
            });
            <span class="hljs-keyword">this</span>.menu.addMenuItem(item);
        }        
});

<span class="hljs-keyword">let</span> indicator = <span class="hljs-literal">null</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`initializing <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 
} 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enable</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`enabling <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>);

    indicator = <span class="hljs-keyword">new</span> Indicator();
    Main.panel.addToStatusArea(<span class="hljs-string">`<span class="hljs-subst">${Me.metadata.name}</span> Indicator`</span>, indicator);
} 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable</span>(<span class="hljs-params"></span>) </span>{ 
    log(<span class="hljs-string">`disabling <span class="hljs-subst">${Me.metadata.name}</span> version <span class="hljs-subst">${Me.metadata.version}</span>`</span>); 

    <span class="hljs-keyword">if</span> (indicator !== <span class="hljs-literal">null</span>) {
        indicator.destroy();
        indicator = <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<p>Son olarak da alt+f2 yapıp r komutunu çalıştıralım. İnce ayarlar uygulamasına baktığımızda eklentimizin isminin orada olduğunu göreceğiz.</p>
<p><img src="https://github.com/busracagliyan/Gnome-Extension-Examples/blob/main/assets/example.drawio.png" alt="alt text"></p>
<p>Artık eklentimiz çalışır konumda. </p>
<p><img src="https://github.com/busracagliyan/Gnome-Extension-Examples/blob/main/assets/screenshot1.png" alt="alt text"></p>
<hr>
<p>İkinci bir yol ise komut satırından gnome-shell eklentisi oluşturmak. Bunun için uç birime </p>
<pre><code>gnome-extensions <span class="hljs-keyword">create</span> –-interactive
</code></pre><p>yazıp çalıştırıyoruz.  </p>
<p>İlk olarak eklentimizin ismini giriyoruz.</p>
<p><img src="https://github.com/busracagliyan/Gnome-Extension-Examples/blob/main/assets/screenshot2.png" alt="alt text"></p>
<p>Sonra eklentimizin açıklamasını giriyoruz.</p>
<p><img src="https://github.com/busracagliyan/Gnome-Extension-Examples/blob/main/assets/screenshot3.png" alt="alt text"></p>
<p>En son olarak da uuid&#39;yi girip bitiriyoruz.</p>
<p><img src="https://github.com/busracagliyan/Gnome-Extension-Examples/blob/main/assets/screenshot4.png" alt="alt text"></p>
<p>Şimdi eklentimizin iskelet kodu hazır. Yukarıda yaptığımız gibi extension.js dosyasına kodu yazıyoruz ve  alt + f2 yapıp eklentimizi çalıştırıyoruz.</p>
<p>Daha fazla bilgi için <a href="https://wiki.gnome.org/Projects/GnomeShell/Extensions">Gnome Wiki</a> sayfasını ziyaret ediniz.</p>
